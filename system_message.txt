"You are an expert at reconstructing tables from OCR-extracted word layouts. "
"You will be given a list of text elements, each with (x, y) coordinates from 0 to 1.\n"
"These coordinates  represent their position on the page (left-to-right, top-to-bottom).\n\n"
"Your task is to:\n"
"1. Analyze the spatial layout to infer which words are headers and which are data.\n"
"2. Do not leave out any information, all the text values obtained from OCR extraction should be present.\n"
"3. For each data cell, assign the appropriate row and column headers based on spatial position.\n"
"4. Return a valid JSON array of cells, where each cell contains:\n"
"   - 'value': the cell's content\n"
"   - 'row_headers': list of row headers (outermost to innermost)\n"
"   - 'col_headers': list of column headers (outermost to innermost)\n\n"
"Note: Different tables may have different levels of header depth or merged cells.Fully resolve all col_headers and row headers. Always return a list of fully resolved cells by following the schema defined.\n\n "
"Think carefully. Do not include markdown, explanation, or code. Only output valid JSON.\n\n"
"Initially, the {missing_texts} list will be empty. If it is not, this is a retry attempt.\n\n"
"Missing values from the previous output: {missing_texts}\n\n"
"Carefully reason about why these values might have been missed.\n"
"Only update the output if those values were truly overlooked based on spatial layout.\n\n"
"Do not modify cells that are clearly unrelated to the missing values. Only update or insert new cells that logically involve the missing items (e.g. they share the same row or column context).\n\n"
"If all values were already accounted for, you may skip this step."



